/*!
 * TrilloJS v0.5.0 (https://github.com/trillo/trillojs#readme)
 * Copyright 2016 Collager Inc.
 * Licensed under the MIT license
 */
Trillo={appLocation:"",OBJ_LOCKED:3,TrilloApp:{},appNamespace:null,isTouchSurface:!1},Trillo.AppInitializer=Class.extend({WIDTH_A:800,WIDTH_B:720,WIDTH_C:640,WIDTH_D:480,WIDTH_E:320,initialize:function(){},initApp:function(a){this.cb=a,this.createAlertComponent(),this.createLogComponent(),this.createSearchHandler(),this.createBuilder(),this.createViewManager(),this.createChartManager(),this.createModelFactory(),this.createObserverFactory(),this.createPage(),this.createRouter(),this.createTitleBarManager(),this.createContextMenuManager(),this.doCallback()},doCallback:function(){this.cb()},createAlertComponent:function(){Trillo.Alert&&(Trillo.alert=new Trillo.Alert)},createLogComponent:function(){Trillo.Log&&(Trillo.log=new Trillo.Log)},createSearchHandler:function(){Trillo.SearchHandler&&(Trillo.searchHandler=new Trillo.SearchHandler)},createViewManager:function(){Trillo.ViewManager&&(Trillo.viewManager=new Trillo.ViewManager)},createChartManager:function(){Trillo.ChartManager&&(Trillo.chartManager=new Trillo.ChartManager)},createBuilder:function(){Trillo.Builder&&(Trillo.builder=new Trillo.Builder)},createModelFactory:function(){Trillo.ModelFactory&&(Trillo.modelFactory=new Trillo.ModelFactory)},createObserverFactory:function(){Trillo.ObserverFactory&&(Trillo.observerFactory=new Trillo.ObserverFactory)},createPage:function(){Trillo.Page&&(Trillo.page=new Trillo.Page)},createRouter:function(){Trillo.Router&&(Trillo.router=new Trillo.Router)},createTitleBarManager:function(){Trillo.TitleBarManager&&(Trillo.titleBarManager=new Trillo.TitleBarManager)},createContextMenuManager:function(){Trillo.ContextMenuManager&&(Trillo.contextMenuManager=new Trillo.ContextMenuManager)}}),Trillo.Options={V_MARGIN_TOP_ROW:10,V_MARGIN:20,H_MARGIN:20,BOTTOM_SPACE_FOR_INF_SCROLL:60,OPEN_ALL:"openAll",CLOSE_ALL:"closeAll",SCROLL_ON_HOVER:"scrollOnHover",AUTO_SCROLL:"autoScroll",SMOOTH_SCROLL:"smoothScroll",NO_SCROLL:"noScroll"},Trillo.Config={viewFileExtension:"",viewPath:null,basePath:null},Trillo.HtmlTemplates={titleBarTitlePrefix:'<li nm="{{viewName}}-title-prefix">{{titlePrefix}}</li>',titleBarTitle:'<li nm="{{viewName}}-title">{{title}}</li>',dropdownListItem:'<li><a class="js-list-item" nm="{{uid}}" href="#">{{name}}</a></li>'},Trillo.CSS={alertDanger:"alert-danger",alertSuccess:"alert-success",pointed:"trillo-pointed",hasErrorCss:"trillo-has-error",hasMessageCss:"trillo-has-message",positionOutside:"trillo-position-outside",selected:"trillo-selected",appRready:"trillo-app-ready",tabActive:"active",treeItemTn:"trillo-tree-item-tn",tnLabel:"trillo-tn-label",treeNode:"tree-node",treeNodeLevelPrefix:"lvl",treeItem:"trillo-tree-item",itemClose:"trillo-item-close",itemOpen:"trillo-item-open",containerPreviewMode:"trillo-container-preview-mode",containerMark:"trillo-container-mark",buttonGroup:"btn-group",dropdown:"dropdown",buttonGroupOpen:"open",dropdownOpen:"open",fieldMsg:"trillo-field-msg"},Trillo.getAllClasses=function(a,b){var c=a.attr("class");return c?b&&(c=c.replace(b,"")):c="",c},Trillo.getRefByQualifiedName=function(a){for(var b=a.split("."),c=b.length,d=0,e=window;e&&c>d;)e=e[b[d++]];return e},Trillo.KeyValue=Class.extend({initialize:function(){this.l=[]},add:function(a,b){this.l.push({k:a,v:b})},getValue:function(a){for(var b=this.l,c=0;c<b.length;c++)if(b[c].k===a)return b[c].v;return null}}),Trillo.uidToClass=function(a){var b,c=null;return a&&(b=a.indexOf("."),b>0&&(c=a.substring(0,b))),c},Trillo.uidToId=function(a){var b,c=null;return a&&(b=a.indexOf("."),b>0&&(c=a.substring(b+1))),c},Trillo.isUid=function(a){if(a){var b=a.indexOf(".");return b>0}return!1},Trillo.offsetByFixedAbsolute=function(a){var b,c=0;a.prevAll().each(function(){b=$(this).css("position"),("fixed"===b||"absolute"===b)&&(c+=$(this).outerHeight())}),a.css("margin-top",c)},Trillo.showBusy=function(){$(".js-busy-indicator").show().css("visibility","visible")},Trillo.hideBusy=function(){$(".js-busy-indicator").css("visibility","hidden")},Trillo.elemId=0,Trillo.getUniqueElemId=function(){return this.elemId++,"_trillo_e_"+this.elemId},Trillo.getObjectValue=function(a,b){if(b&&0!==b.length)for(var c=b.split("."),d=0;d<c.length&&(a=a[c[d]],a);d++);return void 0===a||null===a?null:a},Trillo.setObjectValue=function(a,b,c){for(var d=b.split("."),e=a,f=0;f<d.length-1;f++)e=a[d[f]],e||(e={},a[d[f]]=e),a=e;b=d[d.length-1],a[b]=c},Trillo.mergeObject=function(a,b,c){for(var d=b.split("."),e=a,f=0;f<d.length-1;f++)""!==d[f]&&(e=a[d[f]],e||(e={},a[d[f]]=e),a=e);b=d[d.length-1],""===b?$.extend(a,c):a[b]=c},Trillo.formatValue=function(a,b,c){if(!b||""===b)return c?"":"&nbsp;";var d=a.attr("display-type");if(d){if("date"===d)return this.formatDate(a,b);if("enum"===d||"css-class"===d)return this.getEnumName(a,b)}return b},Trillo.formatDate=function(a,b){var c=a.attr("format")||"M/D/YY hh:mm:ss A";return moment(b).format(c)},Trillo.getEnumName=function(a,b){var c=a.attr("enum-name");return Trillo.enumCatalog.getName(c,b)},Trillo.setCookieValue=function(a,b,c){var d=new Date;d.setDate(d.getDate()+c);var e=escape(b)+";expires="+d.toGMTString(),f=this.getCookieDomain();f&&(e+=";domain="+f),document.cookie=a+"="+e},Trillo.getCookieValue=function(a){a+="=";var b=document.cookie.indexOf(a);if(b>=0){var c=document.cookie.substring(b+a.length);return b=c.indexOf(";"),0>b&&(b=c.length),c=c.substring(0,b),unescape(c)}return""},Trillo.deleteCookie=function(a){""!==Trillo.getCookieValue(a)&&(document.cookie=a+"=;expires=Thu, 01-Jan-1970 00:00:01 GMT")},Trillo.getCookieDomain=function(){var a=document.domain;if(!a||""===a)return null;var b=null,c=a.lastIndexOf(".");if(c>0){var d=a.substring(0,c),e=a.substring(c);c=d.lastIndexOf("."),c>=0?(d=d.substring(c),b=d+e):b="."+d+e}return b},Trillo.matches=function(a,b,c){var d;for(d in a)if("undefined"==typeof b[d])return!1;for(d in a)if(a[d])switch(typeof a[d]){case"object":if(c){if(!Trillo.matches(a[d],b[d]))return!1}else if(a[d]!==b[d])return!1;break;case"function":break;default:if(a[d]!==b[d])return!1}else if(b[d])return!1;for(d in b)if("undefined"==typeof a[d])return!1;return!0},Trillo.isNumeric=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},Trillo.replacer=function(a,b){return 0===a.indexOf("_trillo_")?void 0:b},Trillo.stringify=function(a){return JSON.stringify(a,Trillo.replacer)},Trillo.getSpecObject=function(a,b){var c=a.find(b);if(0===c.length)return null;var d={};return c.each(function(){var a=$(this),b=a.html();if(b&&b.length)try{$.extend(d,$.parseJSON(b))}catch(c){Trillo.log.error("Failed to parse view spec JSON: "+c.message+"<br/>"+b)}}),c.remove(),d},Trillo.getNearestInDOMTree=function(a,b){for(var c=a.find(b);0===c.length&&a.length&&"html"!==(a.prop("nodeName")||"").toLowerCase();)a=a.parent(),c=a.find(b);return c},Trillo.Alert=Class.extend({initialize:function(){this.$e=$(".js-alert"),this.$t=this.$e.find(".js-title"),this.$m=this.$e.find(".js-message"),this.fo=$.proxy(this.fadeOut,this),this.$e.find('[nm="close"]').on("click",$.proxy(this.doAction,this))},show:function(a,b,c,d){this.$e.removeClass(Trillo.CSS.alertDanger).addClass(Trillo.CSS.alertSuccess),this._show(a,b,c,d)},showError:function(a,b,c,d){this.$e.removeClass(Trillo.CSS.alertSuccess).addClass(Trillo.CSS.alertDanger),this._show(a,b,c,d)},_show:function(a,b,c,d){this.$e.finish(),d?this.$e.css("left",d.offset().left+Math.floor(d.width()/2)):this.$e.css("left",0),this.$t.html(a),b=b.replace(/(?:\r\n|\r|\n)/g,"<br />"),this.$m.html(b),this.$e.hide(),this.$e.fadeIn(1e3,c?this.fo:null)},fadeOut:function(a){this.$e.fadeOut(8e3)},doAction:function(a){if(a){a.stopPropagation();var b=$(a.target).attr("nm");"close"===b&&this.clear()}},clear:function(a){this.$e.finish(),this.$e.hide()},notYetImplemented:function(a){this.showError("Not Implemented","Action '"+a+"' is not yet implemented",!0)}});